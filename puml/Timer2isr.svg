<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="991px" preserveAspectRatio="none" style="width:815px;height:991px;" version="1.1" viewBox="0 0 815 991" width="815px" zoomAndPan="magnify"><defs><filter height="300%" id="f1puuwmvkxsiog" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="172.5" cy="20" fill="#000000" filter="url(#f1puuwmvkxsiog)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="79" x="133" y="186.6411"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="143" y="207.7798">push ACC</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="134" x="105.5" y="262.0088"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="114" x="115.5" y="283.1475">clr TMR2CN0_TF2H</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="124" y="337.3765"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="77" x="134" y="358.5151">inc Timer2_X</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="166" x="89.5" y="412.7441"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="146" x="99.5" y="433.8828">set Flag_32ms_Elapsed</text><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="104,488.1118,241,488.1118,253,500.1118,241,512.1118,104,512.1118,92,500.1118,104,488.1118" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="104" y="503.9199">Rcp_Timeout_Cntd == 0</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="70" y="497.5176">YES</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="17" x="253" y="497.5176">NO</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="142" x="11" y="522.1118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="122" x="21" y="543.2505">setb Flag_Rcp_Stop</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="142" x="192" y="522.1118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="122" x="202" y="543.2505">Rcp_Timeout_Cntd--</text><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="172.5,562.0806,184.5,574.0806,172.5,586.0806,160.5,574.0806,172.5,562.0806" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="125" x="110" y="702.8853"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="120" y="724.0239">Rcp_Stop_Cnt++</text><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="115,654.4829,230,654.4829,242,666.4829,230,678.4829,115,678.4829,103,666.4829,115,654.4829" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="176.5" y="688.6934">YES</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="115" x="115" y="670.291">Rcp_Stop_Cnt &lt; 255</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="17" x="242" y="663.8887">NO</text><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="172.5,756.854,184.5,768.854,172.5,780.854,160.5,768.854,172.5,756.854" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="114,606.0806,231,606.0806,243,618.0806,231,630.0806,114,630.0806,102,618.0806,114,606.0806" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="176.5" y="640.291">YES</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="117" x="114" y="621.8887">Flag_Rcp_Stop is set</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="17" x="243" y="615.4863">NO</text><polygon fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" points="172.5,800.854,184.5,812.854,172.5,824.854,160.5,812.854,172.5,800.854" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="72" x="136.5" y="844.854"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="52" x="146.5" y="865.9927">pop ACC</text><rect fill="#FEFECE" filter="url(#f1puuwmvkxsiog)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="41" x="152" y="898.8228"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="21" x="162" y="919.9614">reti</text><ellipse cx="172.5" cy="963.7915" fill="#FFFFFF" filter="url(#f1puuwmvkxsiog)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="172.5" cy="963.7915" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="30" y2="186.6411"/><polygon fill="#A80036" points="168.5,176.6411,172.5,186.6411,176.5,176.6411,172.5,180.6411" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="176.5" y="51.3047">Timer2 interrupt routine</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="37" x="176.5" y="64.1094">Datas:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="283" x="180.5" y="76.9141">- Timer2_X - Counter that increments every 32ms</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="389" x="180.5" y="89.7188">- Flag_32ms_Elapsed - Flag triggered when 32ms elapses in timer 2</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="602" x="180.5" y="102.5234">- Rcp_Timeout_Cntd - RC Pulse Timeout counter is set to 10 each time a rc pulse is processed in timer 1,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="359" x="188.5" y="115.3281">after 320ms without receiving rc pulses in timer 1 it is set to 0</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="623" x="180.5" y="128.1328">- Flag_Rcp_Stop - It is set when rc pulse read in timer 1 is 0 or when Rcp_Timeout_Cntd is timed out (320ms)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="502" x="180.5" y="140.9375">- Rcp_Stop_Cnt - Counts the number of 32ms cycles rc pulse is 0 (Flag_Rcp_Stop == 1).</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="538" x="188.5" y="153.7422">Needed to enter run mode during 320ms (value 10) and exit run mode during 100ms (value 3)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="180.5" y="166.5469"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="220.6099" y2="262.0088"/><polygon fill="#A80036" points="168.5,252.0088,172.5,262.0088,176.5,252.0088,172.5,256.0088" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="176.5" y="241.9146">Clear timer 2 interrupt flag</text><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="295.9775" y2="337.3765"/><polygon fill="#A80036" points="168.5,327.3765,172.5,337.3765,176.5,327.3765,172.5,331.3765" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="176.5" y="317.2822">Increment Timer2_X</text><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="371.3452" y2="412.7441"/><polygon fill="#A80036" points="168.5,402.7441,172.5,412.7441,176.5,402.7441,172.5,406.7441" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="129" x="176.5" y="392.6499">Set 32ms elapsed flag</text><line style="stroke:#A80036;stroke-width:1.5;" x1="92" x2="82" y1="500.1118" y2="500.1118"/><line style="stroke:#A80036;stroke-width:1.5;" x1="82" x2="82" y1="500.1118" y2="522.1118"/><polygon fill="#A80036" points="78,512.1118,82,522.1118,86,512.1118,82,516.1118" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="253" x2="263" y1="500.1118" y2="500.1118"/><line style="stroke:#A80036;stroke-width:1.5;" x1="263" x2="263" y1="500.1118" y2="522.1118"/><polygon fill="#A80036" points="259,512.1118,263,522.1118,267,512.1118,263,516.1118" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="82" x2="82" y1="556.0806" y2="574.0806"/><line style="stroke:#A80036;stroke-width:1.5;" x1="82" x2="160.5" y1="574.0806" y2="574.0806"/><polygon fill="#A80036" points="150.5,570.0806,160.5,574.0806,150.5,578.0806,154.5,574.0806" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="263" x2="263" y1="556.0806" y2="574.0806"/><line style="stroke:#A80036;stroke-width:1.5;" x1="263" x2="184.5" y1="574.0806" y2="574.0806"/><polygon fill="#A80036" points="194.5,570.0806,184.5,574.0806,194.5,578.0806,190.5,574.0806" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="446.7129" y2="488.1118"/><polygon fill="#A80036" points="168.5,478.1118,172.5,488.1118,176.5,478.1118,172.5,482.1118" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="188" x="176.5" y="468.0176">Update RC pulse timeout counter</text><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="678.4829" y2="702.8853"/><polygon fill="#A80036" points="168.5,692.8853,172.5,702.8853,176.5,692.8853,172.5,696.8853" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="242" x2="254" y1="666.4829" y2="666.4829"/><polygon fill="#A80036" points="250,709.8696,254,719.8696,258,709.8696,254,713.8696" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="254" x2="254" y1="666.4829" y2="768.854"/><line style="stroke:#A80036;stroke-width:1.5;" x1="254" x2="184.5" y1="768.854" y2="768.854"/><polygon fill="#A80036" points="194.5,764.854,184.5,768.854,194.5,772.854,190.5,768.854" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="736.854" y2="756.854"/><polygon fill="#A80036" points="168.5,746.854,172.5,756.854,176.5,746.854,172.5,750.854" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="630.0806" y2="654.4829"/><polygon fill="#A80036" points="168.5,644.4829,172.5,654.4829,176.5,644.4829,172.5,648.4829" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="243" x2="267" y1="618.0806" y2="618.0806"/><polygon fill="#A80036" points="263,709.8696,267,719.8696,271,709.8696,267,713.8696" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="267" x2="267" y1="618.0806" y2="812.854"/><line style="stroke:#A80036;stroke-width:1.5;" x1="267" x2="184.5" y1="812.854" y2="812.854"/><polygon fill="#A80036" points="194.5,808.854,184.5,812.854,194.5,816.854,190.5,812.854" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="780.854" y2="800.854"/><polygon fill="#A80036" points="168.5,790.854,172.5,800.854,176.5,790.854,172.5,794.854" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="586.0806" y2="606.0806"/><polygon fill="#A80036" points="168.5,596.0806,172.5,606.0806,176.5,596.0806,172.5,600.0806" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="824.854" y2="844.854"/><polygon fill="#A80036" points="168.5,834.854,172.5,844.854,176.5,834.854,172.5,838.854" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="878.8228" y2="898.8228"/><polygon fill="#A80036" points="168.5,888.8228,172.5,898.8228,176.5,888.8228,172.5,892.8228" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="172.5" x2="172.5" y1="932.7915" y2="952.7915"/><polygon fill="#A80036" points="168.5,942.7915,172.5,952.7915,176.5,942.7915,172.5,946.7915" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[48a5683180669e685ab6a27c051ed143]
@startuml 
start
->Timer2 interrupt routine
Datas:
 - Timer2_X - Counter that increments every 32ms
 - Flag_32ms_Elapsed - Flag triggered when 32ms elapses in timer 2
 - Rcp_Timeout_Cntd - RC Pulse Timeout counter is set to 10 each time a rc pulse is processed in timer 1,
   after 320ms without receiving rc pulses in timer 1 it is set to 0
 - Flag_Rcp_Stop - It is set when rc pulse read in timer 1 is 0 or when Rcp_Timeout_Cntd is timed out (320ms)
 - Rcp_Stop_Cnt - Counts the number of 32ms cycles rc pulse is 0 (Flag_Rcp_Stop == 1).
   Needed to enter run mode during 320ms (value 10) and exit run mode during 100ms (value 3)
 ;
:push ACC;
->Clear timer 2 interrupt flag;
:clr TMR2CN0_TF2H;
->Increment Timer2_X;
:inc Timer2_X;
->Set 32ms elapsed flag;
:set Flag_32ms_Elapsed;
->Update RC pulse timeout counter;
if (Rcp_Timeout_Cntd == 0) then (YES)
  :setb Flag_Rcp_Stop;
else (NO)
  :Rcp_Timeout_Cntd- -;
endif 
if (Flag_Rcp_Stop is set) then (YES)
  if (Rcp_Stop_Cnt < 255) then (YES)
  :Rcp_Stop_Cnt++;
  else (NO)
  endif
else (NO)
endif
:pop ACC;
:reti;
stop
@enduml

PlantUML version 1.2021.5(Sun Apr 25 13:20:28 CEST 2021)
(EPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: es
Country: ES
--></g></svg>